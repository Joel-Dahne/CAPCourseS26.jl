<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Week 3 Lab: A simple computer-assisted proof (and VS Code) · CAPCourseS26.jl</title><meta name="title" content="Week 3 Lab: A simple computer-assisted proof (and VS Code) · CAPCourseS26.jl"/><meta property="og:title" content="Week 3 Lab: A simple computer-assisted proof (and VS Code) · CAPCourseS26.jl"/><meta property="twitter:title" content="Week 3 Lab: A simple computer-assisted proof (and VS Code) · CAPCourseS26.jl"/><meta name="description" content="Documentation for CAPCourseS26.jl."/><meta property="og:description" content="Documentation for CAPCourseS26.jl."/><meta property="twitter:description" content="Documentation for CAPCourseS26.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CAPCourseS26.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><span class="tocitem">Weeks</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Part 1: Introduction to computer-assisted proofs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../week-1-lecture-1/">Week 1 Lecture 1 - Introduction to computer-assisted proofs</a></li><li><a class="tocitem" href="../week-1-lab/">Week 1 Lab: Setup</a></li><li><a class="tocitem" href="../week-2-lecture-1/">Week 2 Lecture 1: Discrete problems</a></li><li><a class="tocitem" href="../week-2-lecture-2/">Week 2 Lecture 2: Integer arithmetic</a></li><li><a class="tocitem" href="../week-2-lab/">Week 2 Lab: Julia basics</a></li><li><a class="tocitem" href="../week-3-lecture-1/">Week 3 Lecture 1: Computer-assisted proofs for continuous problems</a></li><li><a class="tocitem" href="../week-3-lecture-2/">Week 3 Lecture 2: Computer-assisted proofs for continuous problems</a></li><li class="is-active"><a class="tocitem" href>Week 3 Lab: A simple computer-assisted proof (and VS Code)</a><ul class="internal"><li><a class="tocitem" href="#VS-Code-setup"><span>VS Code setup</span></a></li><li><a class="tocitem" href="#A-simple-computer-assisted-proof"><span>A simple computer-assisted proof</span></a></li></ul></li><li><a class="tocitem" href="../week-4-lecture-1/">Week 4 Lecture 1: Formal proofs</a></li><li><a class="tocitem" href="../week-4-lecture-2/">Week 4 Lecture 2: Formal proofs</a></li><li><a class="tocitem" href="../week-4-lab/">Week 4 Lab: Trying Lean</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Part 2: Introduction to rigorous numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../week-5-lecture-1/">Week 5 Lecture 1: Floating point numbers</a></li><li><a class="tocitem" href="../week-5-lecture-2/">Week 5 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-5-lab/">Week 5 Lab: TODO</a></li><li><a class="tocitem" href="../week-6-lecture-1/">Week 6 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-6-lecture-2/">Week 6 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-6-lab/">Week 6 Lab: TODO</a></li><li><a class="tocitem" href="../week-7-lecture-1/">Week 7 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-7-lecture-2/">Week 7 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-7-lab/">Week 7 Lab: TODO</a></li><li><a class="tocitem" href="../week-8-lecture-1/">Week 8 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-8-lecture-2/">Week 8 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-8-lab/">Week 8 Lab: TODO</a></li><li><a class="tocitem" href="../week-9-lecture-1/">Week 9 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-9-lecture-2/">Week 9 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-9-lab/">Week 9 Lab: TODO</a></li><li><a class="tocitem" href="../week-10-lecture-1/">Week 10 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-10-lecture-2/">Week 10 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-10-lab/">Week 10 Lab: TODO</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Part 3: Computer-assisted proofs in practice</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../week-11-lecture-1/">Week 11 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-11-lecture-2/">Week 11 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-11-lab/">Week 11 Lab: TODO</a></li><li><a class="tocitem" href="../week-12-lecture-1/">Week 12 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-12-lecture-2/">Week 12 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-12-lab/">Week 12 Lab: TODO</a></li><li><a class="tocitem" href="../week-13-lecture-1/">Week 13 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-13-lecture-2/">Week 13 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-13-lab/">Week 13 Lab: TODO</a></li><li><a class="tocitem" href="../week-14-lecture-1/">Week 14 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-14-lecture-2/">Week 14 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-14-lab/">Week 14 Lab: TODO</a></li><li><a class="tocitem" href="../week-15-lecture-1/">Week 15 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-15-lecture-2/">Week 15 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-15-lab/">Week 15 Lab: TODO</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Weeks</a></li><li><a class="is-disabled">Part 1: Introduction to computer-assisted proofs</a></li><li class="is-active"><a href>Week 3 Lab: A simple computer-assisted proof (and VS Code)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Week 3 Lab: A simple computer-assisted proof (and VS Code)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Joel-Dahne/CAPCourseS26.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Joel-Dahne/CAPCourseS26.jl/blob/main/docs/src/week-3-lab.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Week-3-Lab:-A-simple-computer-assisted-proof-(and-VS-Code)"><a class="docs-heading-anchor" href="#Week-3-Lab:-A-simple-computer-assisted-proof-(and-VS-Code)">Week 3 Lab: A simple computer-assisted proof (and VS Code)</a><a id="Week-3-Lab:-A-simple-computer-assisted-proof-(and-VS-Code)-1"></a><a class="docs-heading-anchor-permalink" href="#Week-3-Lab:-A-simple-computer-assisted-proof-(and-VS-Code)" title="Permalink"></a></h1><p>The goal of this lab is to reproduce a simple <a href="https://doi.org/10.1063/5.0054122">computer-assisted proof by Alex and Mitch</a>. In doing so we will use VS Code in order to get used to working with Julia from that interface.</p><h2 id="VS-Code-setup"><a class="docs-heading-anchor" href="#VS-Code-setup">VS Code setup</a><a id="VS-Code-setup-1"></a><a class="docs-heading-anchor-permalink" href="#VS-Code-setup" title="Permalink"></a></h2><ol><li><p>Start VS Code</p></li><li><p>Open the course folder. You can find <strong>Open Folder</strong> under <strong>File</strong> (shortcut Ctrl-K Ctrl-O).</p></li><li><p>Create a new file <code>lab-3.jl</code> in the directory <code>scratch/labs</code> (which you will have to create). You can find <strong>New File</strong> under <strong>File</strong> (shortcut Ctrl-Alt-Super-N).</p></li><li><p>Copy the following code into the file</p><pre><code class="language-julia hljs">using Arblib

x = Arb(π)
y = Arb(3)

println(x)</code></pre></li></ol><p>There are multiple different ways to run the code in the file.</p><ol><li>Execute entire file in a separate process. Use the shortcut Ctrl-F5.</li><li>Execute entire file in REPL. Press the arrow in the top right corner.</li><li>Execute the current line in the REPL. Use the shortcut Ctrl-Enter. You can also select multiple lines and it will execute all of them.</li><li>Execute the current line in the REPL and move to the next line. Use the shortcut Shift-Enter.</li></ol><p>Try all of them and see how they work! Which of these alternatives is best depends on your workflow. In my case I almost exclusively make use of alternatives 3 and 4.</p><p>For this lab we will write all of our code inside this one file and use the above commands for running it. For larger projects it is usually a good idea to split the work into multiple files and in many cases it is beneficial to structure the project like a Julia package. We will get back to this later in the course.</p><h2 id="A-simple-computer-assisted-proof"><a class="docs-heading-anchor" href="#A-simple-computer-assisted-proof">A simple computer-assisted proof</a><a id="A-simple-computer-assisted-proof-1"></a><a class="docs-heading-anchor-permalink" href="#A-simple-computer-assisted-proof" title="Permalink"></a></h2><p>Our goal will be to prove Proposition II.2 in paper mentioned above. For this we need the following polynomial</p><p class="math-container">\[P = 1 - 3\alpha^2 + \alpha^4 - \frac{111}{49}\alpha^6 + \frac{143}{294}\alpha^8 - \frac{7536933}{11957764}\alpha^{10} \allowbreak + \frac{4598172331}{47460365316}\alpha^{12} - \frac{30028809212865451}{520327364608478700}\alpha^{14} \allowbreak + \frac{49750141858992227}{12487856750603488800}\alpha^{16}\]</p><p>and the function</p><p class="math-container">\[E(\alpha) = \frac{6\alpha^9}{15 - 20\alpha} \left( 1 + \sqrt{3}\alpha + \sqrt{2}\alpha^2 + \frac{\sqrt{14}}{7}\alpha^3 + \frac{\sqrt{258}}{42}\alpha^4 + \frac{\sqrt{1968837}}{3458}\alpha^5 + \frac{\sqrt{106525799}}{31122}\alpha^6 + \frac{2\sqrt{2129312323981473}}{624696345}\alpha^7 + \frac{\sqrt{183643119755214454}}{4997570760}\alpha^8 \right) + \frac{9\alpha^{18}}{(15 - 20\alpha)^2}\]</p><p>We want to prove the following proposition</p><div class="admonition is-info" id="Proposition-bc8fbe20b6ad7228"><header class="admonition-header">Proposition<a class="admonition-anchor" href="#Proposition-bc8fbe20b6ad7228" title="Permalink"></a></header><div class="admonition-body"><p>The function <span>$P(\alpha) + E(\alpha)$</span> is negative at <span>$\alpha = 0.61$</span> and the function <span>$P(\alpha) + E(\alpha)$</span> is positive at <span>$\alpha = 0.57$</span>.</p></div></div><p>What they are actually trying to prove in the paper is that a function <span>$v(\alpha)$</span> has a zero on the interval <span>$[0.57, 0.61]$</span>. The polynomial <span>$P$</span> is an approximation of <span>$v$</span> and <span>$E(\alpha)$</span> gives an upper bound of the error for the approximation.</p><div class="admonition is-info" id="Note-ad8a4691aff5e526"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ad8a4691aff5e526" title="Permalink"></a></header><div class="admonition-body"><p>The proof in the paper is not quite rigorous. It uses regular floating points together with results that gives you bound on the rounding errors for evaluating polynomials with floating points. It does however not quite account for all the places where rounding errors are introduced.</p><p>Moreover, the expression for <span>$E(\alpha)$</span> seems to not quite be correct. This is being looked into.</p></div></div><h3 id="A-not-quite-correct-implementation"><a class="docs-heading-anchor" href="#A-not-quite-correct-implementation">A not quite correct implementation</a><a id="A-not-quite-correct-implementation-1"></a><a class="docs-heading-anchor-permalink" href="#A-not-quite-correct-implementation" title="Permalink"></a></h3><p>Our first task will be to implement <span>$P$</span> and <span>$E$</span> in Julia. A direct (but as we will see slightly problematic) conversion of the above expressions for <span>$P$</span> and <span>$E$</span> to Julia is given below. You can copy the code into your <code>lab-3.jl</code> file (you can also remove what is already there if you want).</p><pre><code class="language-julia hljs">P(α) =
    1 - 3α^2 + α^4 - 111 / 49 * α^6 + 143 / 294 * α^8 - 7536933 / 11957764 * α^10 +
    4598172331 / 47460365316 * α^12 - 30028809212865451 / 520327364608478700 * α^14 +
    49750141858992227 / 12487856750603488800 * α^16

E(α) =
    6α^9 / (15 - 20α) * (
        1 +
        sqrt(3) * α +
        sqrt(2) * α^2 +
        sqrt(14) / 7 * α^3 +
        sqrt(258) / 42 * α^4 +
        sqrt(1_968_837) / 3458 * α^5 +
        sqrt(106_525_799) / 31_122 * α^6 +
        2sqrt(2_129_312_323_981_473) / 624_696_345 * α^7 +
        sqrt(183_643_119_755_214_454) / 4_997_570_760 * α^8
    ) + 9α^18 / (15 - 20α)^2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">E (generic function with 1 method)</code></pre><p>We can now implement functions computing lower and upper bounds of <span>$v$</span> as</p><pre><code class="language-julia hljs">v_lower(α) = P(α) - E(α)
v_upper(α) = P(α) + E(α)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">v_upper (generic function with 1 method)</code></pre><p>Try evaluating <code>v_lower</code> at <span>$\alpha = 0.57$</span> and <code>v_upper</code> at <span>$\alpha = 0.61$</span>. You should get</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_lower(0.57)</code><code class="nohighlight hljs ansi" style="display:block;">0.02857494349754867</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_upper(0.61)</code><code class="nohighlight hljs ansi" style="display:block;">-0.018830737780968998</code></pre><p>One can show (which we will soon do) that</p><p class="math-container">\[P(0.57) - E(0.57) = 0.02857494349754851842380087961496259058289166470274019410736704418784480353\dots\]</p><p>and</p><p class="math-container">\[P(0.61) + E(0.61) = -0.018830737780969134528206854817563710242534970158515810047488029826855742148\dots.\]</p><p>To what extent do your computed values above agree with these values? If they disagree, what could be the reason? We can also evaluate the functions to higher precision in Julia using <code>BigFloat</code>, Julia&#39;s standard type for arbitrary precision floating points.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_lower(BigFloat(0.57))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `v_lower` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_upper(BigFloat(0.61))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: `v_upper` not defined in `Main`
Suggestion: check for spelling errors or missing imports.</code></pre><p>To what extent do these values agree with the above given ones? What could be the reason for them not agreeing?</p><h3 id="An-improved-implementation"><a class="docs-heading-anchor" href="#An-improved-implementation">An improved implementation</a><a id="An-improved-implementation-1"></a><a class="docs-heading-anchor-permalink" href="#An-improved-implementation" title="Permalink"></a></h3><p>The issue with the above implementation of <span>$P(\alpha)$</span> and <span>$E(\alpha)$</span> is that Julia by default uses <code>Float64</code> for numerical computations unless told otherwise. This happens for example when dividing integers with each other and when computing square roots of integers.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; 1 / 3</code><code class="nohighlight hljs ansi" style="display:block;">0.3333333333333333</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sqrt(2)</code><code class="nohighlight hljs ansi" style="display:block;">1.4142135623730951</code></pre><p>To make our implementation of <span>$P$</span> and <span>$E$</span> work for rigorous numerics we need to make sure that all intermediate computations are also done in a rigorous way. For integer division one way of achieving this is to represent the coefficient as a rational number, which is an exact representation.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; 1 / 3 # Performs floating point arithmetic</code><code class="nohighlight hljs ansi" style="display:block;">0.3333333333333333</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 1 // 3 # Represents it as a rational number</code><code class="nohighlight hljs ansi" style="display:block;">1//3</code></pre><p>This plays well with for example <code>BigFloat</code> (and rigorous numerics as well)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; (1 / 3) * BigFloat(3) # Not close to 1</code><code class="nohighlight hljs ansi" style="display:block;">0.999999999999999944488848768742172978818416595458984375</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; (1 // 3) * BigFloat(3) # Very close to 1</code><code class="nohighlight hljs ansi" style="display:block;">1.0</code></pre><p>Let us define a new function <code>P_correct</code> which represents the coefficients as rational numbers.</p><pre><code class="language-julia hljs">P_correct(α) =
    1 - 3α^2 + α^4 - 111 // 49 * α^6 + 143 // 294 * α^8 - 7536933 // 11957764 * α^10 +
    4598172331 // 47460365316 * α^12 - 30028809212865451 // 520327364608478700 * α^14 +
    49750141858992227 // 12487856750603488800 * α^16</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">P_correct (generic function with 1 method)</code></pre><p>For the square roots we don&#39;t have a way of exactly representing the values (at least not without using any external package). Instead we take the approach of converting the integer to the right type before computing the square root.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; BigFloat(sqrt(2))^2 # This gives large errors</code><code class="nohighlight hljs ansi" style="display:block;">2.000000000000000273432346306476928068849165079572323519550202048158937806476843</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sqrt(BigFloat(2))^2 # This is very precise</code><code class="nohighlight hljs ansi" style="display:block;">1.999999999999999999999999999999999999999999999999999999999999999999999999999983</code></pre><p>For the function <code>E</code> the type we want to convert the integers is given by the type of the argument <code>α</code>. For this you can use the function <code>oftype</code>.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; a = BigFloat(2)</code><code class="nohighlight hljs ansi" style="display:block;">2.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; oftype(a, 1 // 3) # Convert 1 // 3 to the type of a</code><code class="nohighlight hljs ansi" style="display:block;">0.3333333333333333333333333333333333333333333333333333333333333333333333333333348</code></pre><p>Using this for <code>E</code> we get</p><pre><code class="language-julia hljs">E_correct(α) =
    6α^9 / (15 - 20α) * (
        1 +
        sqrt(oftype(α, 3)) * α +
        sqrt(oftype(α, 2)) * α^2  +
        sqrt(oftype(α, 14)) / 7 * α^3  +
        sqrt(oftype(α, 258)) / 42 * α^4  +
        sqrt(oftype(α, 1_968_837)) / 3458 * α^5  +
        sqrt(oftype(α, 106_525_799)) / 31_122 * α^6  +
        2sqrt(oftype(α, 2_129_312_323_981_473)) / 624_696_345 * α^7  +
        sqrt(oftype(α, 183_643_119_755_214_454)) / 4_997_570_760 * α^8
    ) + 9α^18 / (15 - 20α)^2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">E_correct (generic function with 1 method)</code></pre><p>Note that we are not converting the integers we are dividing by. Why do we not need to do that?</p><p>Let us finally define</p><pre><code class="language-julia hljs">v_lower_correct(α) = P_correct(α) - E_correct(α)
v_upper_correct(α) = P_correct(α) + E_correct(α)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">v_upper_correct (generic function with 1 method)</code></pre><p>After this we can now compute</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_lower_correct(BigFloat(0.57))</code><code class="nohighlight hljs ansi" style="display:block;">0.02857494349754871878571474018971654201145414101865307864256544100712321303070467</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_upper_correct(BigFloat(0.61))</code><code class="nohighlight hljs ansi" style="display:block;">-0.01883073778096910557923201578300859364370936517170430979060490885914945724873648</code></pre><p>How does this compare to the values given above? What is the issue now?</p><p>The last issue comes from using the constants <code>0.57</code> and <code>0.61</code>. We have</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; BigFloat(0.57)</code><code class="nohighlight hljs ansi" style="display:block;">0.56999999999999995115018691649311222136020660400390625</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; BigFloat(0.61)</code><code class="nohighlight hljs ansi" style="display:block;">0.60999999999999998667732370449812151491641998291015625</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; BigFloat(&quot;0.57&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">0.5700000000000000000000000000000000000000000000000000000000000000000000000000041</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; BigFloat(&quot;0.61&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">0.6100000000000000000000000000000000000000000000000000000000000000000000000000003</code></pre><p>Finally we thus compute</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_lower_correct(BigFloat(&quot;0.57&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">0.02857494349754851842380087961496259058289166470274019410736704418784480353726142</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_upper_correct(BigFloat(&quot;0.61&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">-0.01883073778096913452820685481756371024253497015851581004748802982685574214828659</code></pre><p>Now it should agree with the values given above!</p><div class="admonition is-info" id="Note-3616acba45849780"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-3616acba45849780" title="Permalink"></a></header><div class="admonition-body"><p>This last fix, using <code>BigFloat(&quot;0.57&quot;)</code> instead of <code>BigFloat(0.57)</code>, is not strictly necessary for a computer-assisted proof. There is nothing special about the value <span>$0.57 = 57 / 100$</span>, we could just as well use the value <span>$0.56999999999999995115018691649311222136020660400390625$</span> which is the exact value for the <code>Float64</code> number that is closest to <span>$0.57 = 57 / 100$</span>. Of course, the statement in the paper would look slightly awkward: &quot;it is positive at <span>$\alpha = 0.56999999999999995115018691649311222136020660400390625$</span>&quot; doesn&#39;t look quite as nice as &quot;it is positive at <span>$\alpha = 0.57$</span>&quot;</p></div></div><h3 id="A-computer-assisted-proof"><a class="docs-heading-anchor" href="#A-computer-assisted-proof">A computer-assisted proof</a><a id="A-computer-assisted-proof-1"></a><a class="docs-heading-anchor-permalink" href="#A-computer-assisted-proof" title="Permalink"></a></h3><p>So far we have of course not proved anything, we have still only evaluated the functions using floating point arithmetic which will give us rounding errors. With the <code>P_correct</code> and <code>E_correct</code> implementations it is however very straightforward to fully prove the result. For this we will use the Arblib.jl package which implements one type of interval arithmetic. To load the package you can add this to the top of your file (it doesn&#39;t <strong>have</strong> to be at the top, but you usually put packages there)</p><pre><code class="language-julia hljs">using Arblib</code></pre><p>We can now evaluate our functions using interval arithmetic</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_lower_correct(Arb(&quot;0.57&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">[0.028574943497548518423800879614962590582891664702740194107367044187844803537 +/- 3.98e-76]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; v_upper_correct(Arb(&quot;0.61&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">[-0.018830737780969134528206854817563710242534970158515810047488029826855742148 +/- 3.82e-76]</code></pre><p>This gives us fully rigorous enclosures for the values. From these enclosures we immediately see that <span>$P(0.57) - E(0.57)$</span> is positive and <span>$P(0.61) + E(0.61)$</span> is negative. We have thus finished the proof!</p><h3 id="Bonus:-Tighten-enclosure-of-root"><a class="docs-heading-anchor" href="#Bonus:-Tighten-enclosure-of-root">Bonus: Tighten enclosure of root</a><a id="Bonus:-Tighten-enclosure-of-root-1"></a><a class="docs-heading-anchor-permalink" href="#Bonus:-Tighten-enclosure-of-root" title="Permalink"></a></h3><p>So far we have proved that there is a root in the interval <span>$[0.57, 0.61]$</span>. Can you compute a tighter enclosure of the root?</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../week-3-lecture-2/">« Week 3 Lecture 2: Computer-assisted proofs for continuous problems</a><a class="docs-footer-nextpage" href="../week-4-lecture-1/">Week 4 Lecture 1: Formal proofs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 16 February 2026 20:19">Monday 16 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
