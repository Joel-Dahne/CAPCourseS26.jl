<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Week 5 Lecture 1: Floating point numbers · CAPCourseS26.jl</title><meta name="title" content="Week 5 Lecture 1: Floating point numbers · CAPCourseS26.jl"/><meta property="og:title" content="Week 5 Lecture 1: Floating point numbers · CAPCourseS26.jl"/><meta property="twitter:title" content="Week 5 Lecture 1: Floating point numbers · CAPCourseS26.jl"/><meta name="description" content="Documentation for CAPCourseS26.jl."/><meta property="og:description" content="Documentation for CAPCourseS26.jl."/><meta property="twitter:description" content="Documentation for CAPCourseS26.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CAPCourseS26.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><span class="tocitem">Weeks</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Part 1: Introduction to computer-assisted proofs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../week-1-lecture-1/">Week 1 Lecture 1 - Introduction to computer-assisted proofs</a></li><li><a class="tocitem" href="../week-1-lab/">Week 1 Lab: Setup</a></li><li><a class="tocitem" href="../week-2-lecture-1/">Week 2 Lecture 1: Discrete problems</a></li><li><a class="tocitem" href="../week-2-lecture-2/">Week 2 Lecture 2: Integer arithmetic</a></li><li><a class="tocitem" href="../week-2-lab/">Week 2 Lab: Julia basics</a></li><li><a class="tocitem" href="../week-3-lecture-1/">Week 3 Lecture 1: Computer-assisted proofs for continuous problems</a></li><li><a class="tocitem" href="../week-3-lecture-2/">Week 3 Lecture 2: Computer-assisted proofs for continuous problems</a></li><li><a class="tocitem" href="../week-3-lab/">Week 3 Lab: A simple computer-assisted proof (and VS Code)</a></li><li><a class="tocitem" href="../week-4-lecture-1/">Week 4 Lecture 1: Formal proofs</a></li><li><a class="tocitem" href="../week-4-lecture-2/">Week 4 Lecture 2: Formal proofs</a></li><li><a class="tocitem" href="../week-4-lab/">Week 4 Lab: Trying Lean</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Part 2: Introduction to rigorous numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Week 5 Lecture 1: Floating point numbers</a><ul class="internal"><li><a class="tocitem" href="#Floating-point-numbers"><span>Floating point numbers</span></a></li><li><a class="tocitem" href="#Definition-of-floating-point-numbers"><span>Definition of floating point numbers</span></a></li><li><a class="tocitem" href="#The-&quot;field&quot;-of-floating-point-numbers-and-rounding"><span>The &quot;field&quot; of floating point numbers and rounding</span></a></li></ul></li><li><a class="tocitem" href="../week-5-lecture-2/">Week 5 Lecture 2: Floating point numbers</a></li><li><a class="tocitem" href="../week-5-lab/">Week 5 Lab: Playing with floating points</a></li><li><a class="tocitem" href="../week-6-lecture-1/">Week 6 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-6-lecture-2/">Week 6 Lecture 2: Interval Arithmetic</a></li><li><a class="tocitem" href="../week-6-lab/">Week 6 Lab: IntervalArithmetic.jl and Arblib.jl</a></li><li><a class="tocitem" href="../week-7-lecture-1/">Week 7 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-7-lecture-2/">Week 7 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-7-lab/">Week 7 Lab: TODO</a></li><li><a class="tocitem" href="../week-8-lecture-1/">Week 8 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-8-lecture-2/">Week 8 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-8-lab/">Week 8 Lab: TODO</a></li><li><a class="tocitem" href="../week-9-lecture-1/">Week 9 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-9-lecture-2/">Week 9 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-9-lab/">Week 9 Lab: TODO</a></li><li><a class="tocitem" href="../week-10-lecture-1/">Week 10 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-10-lecture-2/">Week 10 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-10-lab/">Week 10 Lab: TODO</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Part 3: Computer-assisted proofs in practice</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../week-11-lecture-1/">Week 11 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-11-lecture-2/">Week 11 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-11-lab/">Week 11 Lab: TODO</a></li><li><a class="tocitem" href="../week-12-lecture-1/">Week 12 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-12-lecture-2/">Week 12 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-12-lab/">Week 12 Lab: TODO</a></li><li><a class="tocitem" href="../week-13-lecture-1/">Week 13 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-13-lecture-2/">Week 13 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-13-lab/">Week 13 Lab: TODO</a></li><li><a class="tocitem" href="../week-14-lecture-1/">Week 14 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-14-lecture-2/">Week 14 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-14-lab/">Week 14 Lab: TODO</a></li><li><a class="tocitem" href="../week-15-lecture-1/">Week 15 Lecture 1: TODO</a></li><li><a class="tocitem" href="../week-15-lecture-2/">Week 15 Lecture 2: TODO</a></li><li><a class="tocitem" href="../week-15-lab/">Week 15 Lab: TODO</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Weeks</a></li><li><a class="is-disabled">Part 2: Introduction to rigorous numerics</a></li><li class="is-active"><a href>Week 5 Lecture 1: Floating point numbers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Week 5 Lecture 1: Floating point numbers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Joel-Dahne/CAPCourseS26.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Joel-Dahne/CAPCourseS26.jl/blob/main/docs/src/week-5-lecture-1.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Week-5-Lecture-1:-Floating-point-numbers"><a class="docs-heading-anchor" href="#Week-5-Lecture-1:-Floating-point-numbers">Week 5 Lecture 1: Floating point numbers</a><a id="Week-5-Lecture-1:-Floating-point-numbers-1"></a><a class="docs-heading-anchor-permalink" href="#Week-5-Lecture-1:-Floating-point-numbers" title="Permalink"></a></h1><p>This lecture marks the start of our study of rigorous numerics, which will continue for six weeks. On a high level, these weeks are divided into five parts.</p><ol><li><strong>Mathematical foundations of floating point arithmetic:</strong> floating point formats, rounding</li><li><strong>Basics of interval arithmetic:</strong> basic arithmetic, elementary functions, special functions</li><li><strong>Basic rigorous numerics:</strong> isolating roots, computing integrals, enclosing extrema</li><li><strong>Automatic differentiation:</strong> forward (and backwards) differentiation, Taylor arithmetic</li><li><strong>Improved rigorous numerics:</strong> isolating roots, computing integrals, enclosing extrema</li></ol><p>We will start with the basics, floating point numbers, and progressively work our way up to how rigorous numerics can be used to solve problems. At every stage we will make sure that we understand how the computer can perform these computations in a rigorous way.</p><h2 id="Floating-point-numbers"><a class="docs-heading-anchor" href="#Floating-point-numbers">Floating point numbers</a><a id="Floating-point-numbers-1"></a><a class="docs-heading-anchor-permalink" href="#Floating-point-numbers" title="Permalink"></a></h2><p>In rigorous numerics one usually works primarily with intervals and interval arithmetic, in fact the field of rigorous numerics is often referred to as just interval arithmetic. The underlying basis of interval arithmetic is however floating points. To fully understand how interval arithmetic works we therefore have to start by understanding how floating point numbers work. For this we will look at:</p><ul><li>The mathematical definition of floating point numbers</li><li>Actual implementation of floating points</li><li>Arithmetic with floating point numbers</li><li>Rounding</li></ul><h2 id="Definition-of-floating-point-numbers"><a class="docs-heading-anchor" href="#Definition-of-floating-point-numbers">Definition of floating point numbers</a><a id="Definition-of-floating-point-numbers-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-floating-point-numbers" title="Permalink"></a></h2><p>There are several different versions of floating point numbers, depending on the precise use case. Let us start with the most mathematical definition.</p><div class="admonition is-info" id="Floating-point-number-910113e07a62329a"><header class="admonition-header">Floating point number<a class="admonition-anchor" href="#Floating-point-number-910113e07a62329a" title="Permalink"></a></header><div class="admonition-body"><p>A binary floating point number is a rational number of the form <span>$x \cdot 2^y$</span> where <span>$x, y \in \mathbb{Z}$</span> and <span>$x$</span> is odd, or one of the special values zero, plus infinity, negative infinity or NaN (not-a-number).</p></div></div><p>We use the notation <span>$\mathbb{F}$</span> for the set of floating point numbers, i.e.</p><p class="math-container">\[\mathbb{F} = \{x \cdot 2^y: x, y \in \mathbb{Z}, x\ \text{odd}\} \cup \{0, \infty, -\infty, \text{NaN}\}\]</p><p>There are a number of equivalent ways of representing a floating point. Apart from <span>$x \cdot 2^y$</span> used above the two most common ones are</p><ol><li><span>$m \cdot 2^e$</span> with <span>$1 \leq |m| &lt; 2$</span></li><li><span>$m&#39; \cdot 2^{e&#39;}$</span> with <span>$0.5 \leq |m&#39;| &lt; 1$</span></li></ol><p>The first one is arguably the most common format and in this case <span>$m$</span> is called the mantissa and <span>$e$</span> the exponent. Depending on the context mantissa and exponent could also be used to refer to <span>$x$</span> and <span>$y$</span> or <span>$m&#39;$</span> and <span>$e&#39;$</span>.</p><p>Generally we consider floating points of a specified precision <span>$p$</span>. The set of floating point numbers of precision <span>$p$</span> is</p><p class="math-container">\[\mathbb{F}_p = \{x \cdot 2^y: x, y \in \mathbb{Z}, 1 \leq x &lt; 2^p, x\ \text{odd}\} \cup \{0, \infty, -\infty, \text{NaN}\}.\]</p><p>If we write the mantissa in binary it is then of the form</p><p class="math-container">\[m = \pm 1.b_1 b_2 \dots b_{p-1}\]</p><p>Note that we only need <span>$p - 1$</span> bits to store the mantissa since the first digit is implicitly defined to be a one. In the <span>$x \cdot 2^y$</span> representation we also only need <span>$p - 1$</span> bits to store <span>$x$</span> since it is always odd and we therefore don&#39;t have to store the last bit.</p><p>The set <span>$\mathbb{F}_p$</span> corresponds to the type <code>arf</code> in Flint. In Julia we can get the representations <span>$m \cdot 2^e$</span> using <code>significand</code> and <code>exponent</code> and the representation <span>$m&#39; \cdot 2^{e&#39;}$</span> using <code>frexp</code>.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Arblib</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; f = Arf(3 * 2^4)</code><code class="nohighlight hljs ansi" style="display:block;">48.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; significand(f), exponent(f)</code><code class="nohighlight hljs ansi" style="display:block;">(1.5, 5)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; frexp(f)</code><code class="nohighlight hljs ansi" style="display:block;">(0.75, 6)</code></pre><p>Most floating point types are however more restrictive than <code>arf</code>. They generally also put restrictions on the range of the exponent. They correspond to the set</p><p class="math-container">\[\mathbb{F}_{p,\check{y},\hat{y}} = \{x \cdot 2^y: x, y \in \mathbb{Z}, 1 \leq x &lt; 2^p, x\ \text{odd}, \check{y} \leq y \leq \hat{y}\} \cup \{0, \infty, -\infty, \text{NaN}\}.\]</p><p>Usually the bounds for the exponent are given in terms of <span>$e$</span>. For example for <code>BigFloat</code> they are <span>$-2^{62} \leq e \leq 2^{62} - 2$</span> and for <code>Float64</code> they are <span>$-1022 \leq e \leq 1023$</span>. We can find this using Julia as</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; exponent(floatmax(BigFloat))</code><code class="nohighlight hljs ansi" style="display:block;">4611686018427387902</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 2^62 - 2</code><code class="nohighlight hljs ansi" style="display:block;">4611686018427387902</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; exponent(floatmin(BigFloat))</code><code class="nohighlight hljs ansi" style="display:block;">-4611686018427387904</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; -2^62</code><code class="nohighlight hljs ansi" style="display:block;">-4611686018427387904</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; exponent(floatmax(Float64))</code><code class="nohighlight hljs ansi" style="display:block;">1023</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; exponent(floatmin(Float64))</code><code class="nohighlight hljs ansi" style="display:block;">-1022</code></pre><p>The definitions we have gone through so far are enough for our study of floating point numbers. Many common floating point types, primarily <code>Float64</code>, do however have a few more details that in some cases are important:</p><ul><li><p><strong>Signed zero:</strong> The value zero can also have a sign, meaning that <code>0</code> and <code>-0</code> are distinct values. This is useful in some cases, but mathematically it can give some odd behavior. We will in general not consider signed zeros.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; 0.0</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; -0.0</code><code class="nohighlight hljs ansi" style="display:block;">-0.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 0.0 == -0.0</code><code class="nohighlight hljs ansi" style="display:block;">true</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; isequal(0.0, -0.0)</code><code class="nohighlight hljs ansi" style="display:block;">false</code></pre></li><li><p><strong>Subnormal numbers:</strong> In general the mantissa satisfies <span>$1 \leq |m| &lt; 2$</span>. For the numbers closest to zero it however allows representations where <span>$|m| &lt; 1$</span>. We won&#39;t care about this at all.</p></li><li><p><strong>NaN with payload:</strong> The NaN values can have extra data associated with them. This is for example used in the R programming language to represent missing values. We won&#39;t care about this at all.</p></li></ul><p>Note that the <code>Arf</code> floating point type does not support any of these things.</p><h2 id="The-&quot;field&quot;-of-floating-point-numbers-and-rounding"><a class="docs-heading-anchor" href="#The-&quot;field&quot;-of-floating-point-numbers-and-rounding">The &quot;field&quot; of floating point numbers and rounding</a><a id="The-&quot;field&quot;-of-floating-point-numbers-and-rounding-1"></a><a class="docs-heading-anchor-permalink" href="#The-&quot;field&quot;-of-floating-point-numbers-and-rounding" title="Permalink"></a></h2><p>We now know what floating point numbers are, the next step is to be able to do computations on floating point numbers. In this lecture we will focus on basic arithmetic, i.e. addition, subtraction, multiplication and division. In the next lecture we will look at powers and elementary functions.</p><p>Except for the special values <span>$\pm \infty$</span> and NaN, floating point numbers are a subset of the rational numbers. We therefore have a natural definition for what it means to add, subtract, multiply and divide floating point numbers with each other. There is however a problem, the set of floating point numbers is not closed under these operations.</p><div class="admonition is-info" id="Example-545d324bcc1f785f"><header class="admonition-header">Example<a class="admonition-anchor" href="#Example-545d324bcc1f785f" title="Permalink"></a></header><div class="admonition-body"><p>Consider the floating point numbers <span>$a = 3 \cdot 2^0$</span> and <span>$b = 5 \cdot 2^0$</span> in the set <span>$\mathbb{F}_3$</span>. We have</p><p class="math-container">\[c = a \cdot b = 15 \cdot 2^0.\]</p><p>But <span>$15 \cdot 2^0$</span> is not in the set <span>$\mathbb{F}_3$</span> since <span>$15 &gt; 2^3$</span>.</p></div></div><p>To fix this problem we have to introduce the concept of rounding.</p><h3 id="Rounding"><a class="docs-heading-anchor" href="#Rounding">Rounding</a><a id="Rounding-1"></a><a class="docs-heading-anchor-permalink" href="#Rounding" title="Permalink"></a></h3><p>A rounding function is a function</p><p class="math-container">\[\bigcirc: \mathbb{R} \to \mathbb{F}_{p}\]</p><p>To be a proper rounding function it should satisfy</p><ol><li><span>$\bigcirc(x) = x$</span> for <span>$x \in \mathbb{F}_{p}$</span></li><li><span>$\bigcirc(x) \leq \bigcirc(y)$</span> if <span>$x \leq y$</span></li></ol><p>We will look at three different versions of rounding:</p><ol><li>Round down: <span>$\nabla(x)$</span></li><li>Round up: <span>$\Delta(x)$</span></li><li>Round to nearest (even): <span>$\square(x)$</span></li></ol><p>The round down and up are defined by</p><ul><li><span>$\nabla(x) = \max \{y \in \mathbb{F}_{p}: y \leq x\}$</span></li><li><span>$\Delta(x) = \min \{y \in \mathbb{F}_{p}: y \geq x\}$</span></li></ul><p>That is, they return the floating point number just below or just above <span>$x$</span>. Round to nearest on the other hand returns the floating point number closest to <span>$x$</span>, with ties being rounded to the one of two which has a 0 in the last digit of the mantissa.</p><p>For general use round to nearest is the by far most common rounding mode to use. For the specific purposes of interval arithmetic round up and round down will however be very important.</p><div class="admonition is-info" id="Note-608580acef85c84c"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-608580acef85c84c" title="Permalink"></a></header><div class="admonition-body"><p>The rounding function implicitly depends on the precision <span>$p$</span> of the set we are rounding into. In some cases one might want to use the notation <span>$\bigcirc_p$</span> to make this dependency explicit.</p></div></div><h3 id="Arithmetic-with-rounding"><a class="docs-heading-anchor" href="#Arithmetic-with-rounding">Arithmetic with rounding</a><a id="Arithmetic-with-rounding-1"></a><a class="docs-heading-anchor-permalink" href="#Arithmetic-with-rounding" title="Permalink"></a></h3><p>With our new rounding functions we can now define arithmetic on floating points!</p><p>When adding two floating point numbers <span>$x, y \in \mathbb{F}_p$</span> under the rounding mode <span>$\bigcirc$</span> the result is given by <span>$z = \bigcirc(x + y)$</span>. Here the operation <span>$x + y$</span> is the exact addition, corresponding to addition of rational numbers. We similarly have that <span>$\bigcirc(x - y)$</span>, <span>$\bigcirc(x \cdot y)$</span> and <span>$\bigcirc(x / y)$</span> are the floating point operations corresponding to subtraction, multiplication and division under rounding mode <span>$\bigcirc$</span>. In some cases we will use the notation <span>$\bigcirc(+)$</span> to denote floating point addition under the rounding mode <span>$\bigcirc$</span> (so <span>$\nabla(+)$</span> for round down and <span>$\Delta(+)$</span> for round up).</p><p>A natural question is, how does the computer compute <span>$\bigcirc(a + b)$</span>? The value <span>$a + b$</span> is not (necessarily) representable as a floating point number, how can the computer then work with it? The key is to remember that both <span>$a$</span> and <span>$b$</span> are of the form <span>$x \cdot 2^y$</span>. If we write <span>$a = x_a \cdot 2^{y_a}$</span> and <span>$b = x_b \cdot 2^{y_b}$</span> then</p><p class="math-container">\[a \cdot b = x_ax_b \cdot 2^{y_a + y_b}.\]</p><p>Computing this number requires multiplying the two integers <span>$x_a$</span> and <span>$x_b$</span> and adding the integers <span>$y_a$</span> and <span>$y_b$</span>. The computer can this; it is just integer arithmetic! Rounding the result then requires some manipulation of these integers, but throughout the computations we are only working with integers.</p><div class="admonition is-info" id="Note-6ad919fd81c3ed36"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-6ad919fd81c3ed36" title="Permalink"></a></header><div class="admonition-body"><p>In practice most floating point implementations do not compute e.g. <span>$x_ax_b$</span> directly. They use more optimized routines that handle the multiplication and the rounding in one step. At the most fundamental level everything is however just integer arithmetic.</p></div></div><p>With this we finally have a mathematically well defined notion of arithmetic for floating points! This definition does however come with a number of awkward mathematical properties. These issues are a result of the problem that rounding does not compose. For example, <span>$\bigcirc(\bigcirc(x + y) + z)$</span> is in general not the same as <span>$\bigcirc(x + \bigcirc(y + z))$</span> and neither of them are (in general) the same as <span>$\bigcirc(x + y + z)$</span>. This means that floating point addition is non-associative (it is however commutative).</p><p>Working with non-associative operations is in general very tedious, it means you have to be extremely careful when you specify your expressions to make sure that the order of the operations is well defined.</p><div class="admonition is-info" id="Example-d74404bbae3ffba4"><header class="admonition-header">Example<a class="admonition-anchor" href="#Example-d74404bbae3ffba4" title="Permalink"></a></header><div class="admonition-body"><p>Consider the sum</p><p class="math-container">\[S = \sum_{n = 1}^{10^4} \frac{1}{n}.\]</p><p>If we were to exactly compute this sum and then round it to a floating point then we would get the value <span>$\bigcirc(S)$</span>. If we want to use floating points to compute the sum we round each individual operation. As a first step we can round the divisions, giving us</p><p class="math-container">\[S&#39; = \sum_{n = 1}^{10^4} \bigcirc(1 / n).\]</p><p>If we were to perform this sum exactly we would get the floating point number <span>$\bigcirc(S&#39;)$</span>. Of course, we also have rounding when computing the sum. If we sum from the left we get</p><p class="math-container">\[S_l = \bigcirc(\cdots\bigcirc(\bigcirc(\bigcirc(1 / 1) + \bigcirc(1 / 2)) + \bigcirc(1 / 3))\cdots),\]</p><p>if we sum from the right we get</p><p class="math-container">\[S_r = (\cdots \bigcirc(\bigcirc(1 / (10^4 - 2)) + \bigcirc(\bigcirc(1 / (10^4 - 1)) + \bigcirc(1 / 10^4)))\cdots).\]</p><p>In Julia this would correspond to</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; S_l = 0.0</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for n in 1:10^4
           S_l += 1.0 / n
       end</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; S_l</code><code class="nohighlight hljs ansi" style="display:block;">9.787606036044348</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; S_r = 0.0</code><code class="nohighlight hljs ansi" style="display:block;">0.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for n in reverse(1:10^4)
           S_r += 1.0 / n
       end</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; S_r</code><code class="nohighlight hljs ansi" style="display:block;">9.787606036044386</code></pre><p>We can see that these mostly agree, but are not exactly the same. We can also compute the entire sum exactly using rational numbers and then round to a floating point. This gives us</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; S = Float64(sum(n -&gt; 1 // BigInt(n), 1:10^4))</code><code class="nohighlight hljs ansi" style="display:block;">9.787606036044382</code></pre><p>We can compare this to <span>$S_l$</span> and <span>$S_r$</span></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; S_l - S</code><code class="nohighlight hljs ansi" style="display:block;">-3.375077994860476e-14</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; S_r - S</code><code class="nohighlight hljs ansi" style="display:block;">3.552713678800501e-15</code></pre><p>The <code>sum</code> function in Julia instead does a pairwise summation, this in general gives much smaller rounding errors.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; S - sum(n -&gt; 1.0 / n, 1:10^4)</code><code class="nohighlight hljs ansi" style="display:block;">1.7763568394002505e-15</code></pre></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../week-4-lab/">« Week 4 Lab: Trying Lean</a><a class="docs-footer-nextpage" href="../week-5-lecture-2/">Week 5 Lecture 2: Floating point numbers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 27 February 2026 18:01">Friday 27 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
